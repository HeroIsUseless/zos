     1                                  ORG 0x7c00 ; 程序的内存装载地址
     2 00000000 EB4D                    JMP entry
     3                                  CYLS EQU 10 ; 声明10个柱面
     4                                  ; 标准FAT12格式软盘专用的代码
     5 00000002 4D794F535F49504C        DB		"MyOS_IPL"		; 启动扇区名称（8字节）
     6 0000000A 0002                    DW		512				; 每个扇区（sector）大小（必须512字节）
     7 0000000C 01                      DB		1				; 簇（cluster）大小（必须为1个扇区）
     8 0000000D 0100                    DW		1				; FAT起始位置（一般为第一个扇区）
     9 0000000F 02                      DB		2				; FAT个数（必须为2）
    10 00000010 E000                    DW		224				; 根目录大小（一般为224项）
    11 00000012 400B                    DW		2880			; 该磁盘大小（必须为2880扇区1440*1024/512）
    12 00000014 F0                      DB		0xf0			; 磁盘类型（必须为0xf0）
    13 00000015 0900                    DW		9				; FAT的长度（必须是9扇区）
    14 00000017 1200                    DW		18				; 一个磁道（track）有几个扇区（必须为18）
    15 00000019 0200                    DW		2				; 磁头数（必须是2）
    16 0000001B 00000000                DD		0				; 不使用分区，必须是0
    17 0000001F 400B0000                DD		2880			; 重写一次磁盘大小
    18 00000023 000029                  DB		0,0,0x29		; 意义不明（固定）
    19 00000026 FFFFFFFF                DD		0xffffffff		; （可能是）卷标号码
    20 0000002A 4D794F535F6469736B-     DB		"MyOS_disk  "	; 磁盘的名称（必须为11字节，不足填空格）
    20 00000033 2020               
    21 00000035 4641543132202020        DB		"FAT12   "		; 磁盘格式名称（必须是8字节，不足填空格）
    22 0000003D 00<rep 12h>             times	18 db 0			; 先空出18字节
    23                                  ; 程序主体
    24                                  entry:
    25 0000004F B80000                      MOV AX, 0 ; 初始化
    26 00000052 8ED0                        MOV SS, AX ; 堆栈地址为0
    27 00000054 BC007C                      MOV SP, 0x7c00 ; 堆栈指针附了特定值
    28 00000057 8ED8                        MOV DS, AX ; DS, ES地址必须置0
    29                                   
    30 00000059 B82008                      MOV AX, 0x0820 ; 读取磁盘
    31 0000005C 8EC0                        MOV ES, AX 
    32 0000005E B500                        MOV CH, 0 ; 柱面0
    33 00000060 B600                        MOV DH, 0 ; 磁头0
    34 00000062 B102                        MOV CL, 2 ; 扇区2，加载下一个扇区
    35                                   
    36                                  readloop: ; 失败重新读取
    37 00000064 BE0000                      MOV SI, 0 ; 记录失败次数寄存器
    38                                  retry:
    39 00000067 B402                        MOV AH, 0x02 ; 读入磁盘
    40 00000069 B001                        MOV AL, 1 ; 一个扇区
    41 0000006B BB0000                      MOV BX, 0
    42 0000006E B200                        MOV DL, 0x00 ; A驱动器
    43 00000070 CD13                        INT 0x13 ; 读入
    44 00000072 7310                        JNC next ; 没出错跳出
    45 00000074 83C601                      ADD SI, 1 ; 计数加1
    46 00000077 83FE05                      CMP SI, 5 ; 重复5次
    47 0000007A 732D                        JAE error ; 5次还不行就出错
    48 0000007C B400                        MOV AH, 0x00
    49 0000007E B200                        MOV DL, 0x00 ; A驱动器
    50 00000080 CD13                        INT 0x13 ; 重置驱动器
    51 00000082 EBE3                        JMP retry 
    52                                  next:
    53 00000084 8CC0                        MOV AX, ES
    54 00000086 83C020                      ADD AX, 0x0020
    55 00000089 8EC0                        MOV ES, AX ; 把内存地址后移512
    56 0000008B 80C101                      ADD CL, 1 ; CL的加1
    57 0000008E 80F912                      CMP CL, 18 ; 读完18个扇区
    58 00000091 76D1                        JBE readloop ; 嗯，到这里
    59 00000093 B101                        MOV CL, 1
    60 00000095 80C601                      ADD DH, 1
    61 00000098 80FE02                      CMP DH, 2
    62 0000009B 72C7                        JB readloop ; 两个正反面
    63 0000009D B600                        MOV DH, 0
    64 0000009F 80C501                      ADD CH, 1
    65 000000A2 80FD0A                      CMP CH, CYLS
    66 000000A5 72BD                        JB readloop ; 读完10个柱面
    67                                   
    68 000000A7 EB15                        JMP halt
    69                                      ;JMP 0xc200 ; 跳转到系统执行
    70                                   
    71                                  error:
    72 000000A9 BE[C700]                    MOV SI, msg
    73                                      putloop:
    74 000000AC 8A04                            MOV AL, [SI] ; 把si中的内容放到AL中
    75 000000AE 83C601                          ADD SI, 1
    76 000000B1 3C00                            CMP AL, 0
    77 000000B3 7409                            JE halt
    78 000000B5 B40E                            MOV AH, 0x0e
    79 000000B7 BB0F00                          MOV BX, 15
    80 000000BA CD10                            INT 0x10
    81 000000BC EBEE                        JMP putloop
    82                                   
    83                                  halt:
    84                                      ;HLT 
    85 000000BE B40E                        MOV		AH,0x0e			; 显示一个文字
    86 000000C0 BB0F00                  	MOV		BX,15			; 指定字符颜色
    87 000000C3 CD10                    	INT		0x10			; 调用显卡BIOS
    88 000000C5 EBF7                        JMP halt
    89                                   
    90                                  ; 信息显示部分
    91                                  msg:
    92 000000C7 0A0A                    DB		0x0a, 0x0a		; 换行两次
    93 000000C9 6C6F6164206572726F-     DB		"load error"
    93 000000D2 72                 
    94 000000D3 0A                      DB		0x0a			; 换行
    95 000000D4 00                      DB		0
    96                                   
    97                                  ;times    0x7dfe-($-$$) db 0 
    98 000000D5 00<rep 129h>            times    510-($-$$) db 0 
    99 000001FE 55AA                    DB		0x55, 0xaa
